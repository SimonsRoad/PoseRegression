% eval_detection_results.m
% 
clc; clear; close all;

testdatatype = 'rTest';
testdataname = 'pet2006';

if strcmp(testdatatype, 'rTest')
    if strcmp(testdataname, 'towncenter')
        nimages = [45 49 29 25 23 21 75 28 16 47];
        IoU = [0.635	0.1446	0.4837	0.3465	0.1499	0.3605	0.5397	1	0.5673	0.7362;
            0.5509	0.1343	0.2548	0.1615	0.1343	0.359	0.5304	1	0.5108	0.6986;
            0.5922	0.1615	0.529	0.4873	0.1792	0.3739	0.5438	1	0.5581	0.7116;
            0.5979	0.1696	0.4731	0.4994	0.197	0.3846	0.5558	1	0.5345	0.7564;
            0.4829	0.1414	0.3131	0.4058	0.1414	0.3744	0.544	1	0.5645	0.7071;
            0.5303	0.148	0.3303	0.4753	0.148	0.3494	0.5202	1	0.4628	0.6832;
            0.6207	0.1479	0.2741	0.1826	0.1676	0.3526	0.5261	1	0.5425	0.7162;
            0.4934	0.13	0.2524	0.3495	0.13	0.36	0.5317	1	0.5492	0.701;
            0.5234	0.1375	0.3951	0.3552	0.1375	0.3769	0.5451	1	0.616	0.7252;
            0.3892	0.0902	0.0902	0.1434	0.1208	0.3445	0.5303	1	0.5135	0.7014];
    elseif strcmp(testdataname, 'pet2006')
        nimages = [288 210 297 284];
        IoU = [
            0.549	0.1189	0.3483	0.2059	0.1356	0.3335	0.5134	1	0.5388	0.7124;
            0.5612	0.1178	0.3891	0.2645	0.1342	0.328	0.5147	1	0.5196	0.7134;
            0.6404	0.1146	0.5416	0.3472	0.1358	0.3294	0.5129	1	0.5314	0.7162;
            0.6487	0.1436	0.2678	0.1837	0.1567	0.3407	0.519	1	0.5283	0.7119];
    else
        error('invalid testdataname!');
    end
elseif strcmp(testdatatype, 'sTest')
    if strcmp(testdataname, 'towncenter')
        nimages = [100 100 100 100 100 100 100 100 100 100];
        IoU = [0.584	0.1316	0.4029	0.4413	0.2892	0.3866	0.5581	1	0.5254	0.7341;
            0.5864	0.133	0.4509	0.403	0.3017	0.3874	0.5635	1	0.5642	0.7225;
            0.5618	0.14	0.6547	0.5828	0.4054	0.3834	0.556	1	0.5545	0.7185;
            0.5002	0.1208	0.4116	0.443	0.409	0.3898	0.5632	1	0.56	0.7171;
            0.5197	0.124	0.4419	0.4501	0.2421	0.396	0.565	1	0.5429	0.7296;
            0.5466	0.126	0.4588	0.4422	0.4185	0.398	0.5656	1	0.5396	0.7264;
            0.6375	0.1481	0.4095	0.3195	0.3194	0.3789	0.5509	1	0.5539	0.737;
            0.4819	0.1121	0.2977	0.4295	0.1655	0.3803	0.5572	1	0.5246	0.7293;
            0.5305	0.1248	0.52	0.497	0.3321	0.3596	0.5381	1	0.5476	0.7214;
            0.3772	0.1164	0.0975	0.1524	0.0808	0.3838	0.5639	1	0.5113	0.7202];
    elseif strcmp(testdataname, 'pet2006')
        nimages = [100 100 100 100];
        IoU = [
            0.5378	0.0913	0.1079	0.1941	0.1149	0.3746	0.5492	1	0.5228	0.7305;
            0.5058	0.0934	0.3163	0.2915	0.1343	0.3669	0.5452	1	0.5221	0.7213;
            0.523	0.0892	0.1757	0.198	0.1164	0.3818	0.5567	1	0.5355	0.7226;
            0.5827	0.1046	0.2881	0.2531	0.2398	0.3876	0.5644	1	0.5476	0.7347];
    else
        error('invalid testdataname!');
    end


else
    error('invalid testdatatype!');
end

%% compute mean IoU
meanIoU = sum(repmat(nimages', [1, size(IoU,2)]).*IoU) / sum(nimages); 
for i=1:numel(meanIoU)
    fprintf('%.4f \t', meanIoU(i));
end; fprintf('\n');